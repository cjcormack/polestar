<?xml version="1.0" encoding="UTF-8"?><script xmlns:hds="http://netkernel.org/hds"><id>3725D19C46848A44</id><name>Switch on lights when dark</name><script>import org.netkernel.mod.hds.*;&#13;
import org.netkernel.layer0.nkf.*;&#13;
&#13;
sensors=context.source("active:polestarSensorState",IHDSDocument.class).getReader();&#13;
light=(double)sensors.getFirstValue("key('byId','urn:daylight')/value");&#13;
changed=io.polestar.ScriptUtils.analogueLevelChangeDetect(&#13;
	value:light,&#13;
	trueThreshold: 0.1D,&#13;
	falseThreshold: 0.05D,&#13;
	context:context );&#13;
day=light&gt;=0.1D;&#13;
if (changed)&#13;
{	if (day)&#13;
	{	context.logRaw(INKFLocale.LEVEL_INFO,"Dawn");&#13;
	}&#13;
	else&#13;
	{	context.logRaw(INKFLocale.LEVEL_INFO,"Dusk");&#13;
	}&#13;
&#13;
	m=HDSFactory.newDocument();&#13;
	m.pushNode("sensors");&#13;
	m.pushNode("sensor");&#13;
	m.addNode("id","urn:switch:test");&#13;
	m.addNode("value", !day);&#13;
	m.popNode();&#13;
&#13;
	req=context.createRequest("active:polestarSensorUpdate");&#13;
	req.addArgumentByValue("state",m.toDocument(false));&#13;
	context.issueRequest(req);&#13;
&#13;
}</script><state>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;state xmlns:hds="http://netkernel.org/hds"&gt;&lt;value hds:type="BOOLEAN"&gt;true&lt;/value&gt;&lt;/state&gt;</state><triggers>urn:daylight</triggers><keywords>control</keywords><public>private</public></script>